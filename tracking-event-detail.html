<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MSHè·Ÿè¸ªäº‹ä»¶è¯¦æƒ…</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="./src/style.css">
  <style>
    /* è·Ÿè¸ªäº‹ä»¶è¯¦æƒ…é¡µé¢ä¸“ç”¨æ ·å¼ */
    .event-detail-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    
    .member-info-card {
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
    }
    
    .absence-details-card {
      background: #fff3cd;
      border: 1px solid #ffeaa7;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
    }
    
    .tracking-records-list {
      background: #d1ecf1;
      border: 1px solid #bee5eb;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
    }
    
    .tracking-record-item {
      background: white;
      border: 1px solid #dee2e6;
      border-radius: 6px;
      padding: 15px;
      margin-bottom: 10px;
    }
    
    .action-buttons {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 20px;
    }
    
    .loading-indicator {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 40px;
      text-align: center;
      color: #666;
    }
    
    .loading-spinner {
      width: 40px;
      height: 40px;
      border: 4px solid #f3f3f3;
      border-top: 4px solid #007bff;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 20px;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .error-message {
      background: #f8d7da;
      border: 1px solid #f5c6cb;
      border-radius: 6px;
      padding: 15px;
      color: #721c24;
      margin: 20px 0;
    }
  </style>
  <!-- å¼•å…¥é…ç½®æ–‡ä»¶ -->
  <script src="./src/smart-config-loader.js"></script>
  <!-- å¼•å…¥é…ç½®ç®¡ç†å™¨ -->
  <script src="./src/config-manager.js"></script>
  <!-- å¼•å…¥ç»Ÿä¸€ç¼“å­˜ç®¡ç†å™¨ -->
  <script src="./src/unified-cache-manager.js"></script>
  <!-- å¼•å…¥å®æ—¶æ›´æ–°ç®¡ç†å™¨ -->
  <script src="./src/real-time-update-manager.js"></script>
  <!-- å¼•å…¥ Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
</head>
<body>
  <main>
    <h1>MSHè·Ÿè¸ªäº‹ä»¶è¯¦æƒ…</h1>
    
    <!-- å¯¼èˆªæŒ‰é’® -->
    <section class="button-row">
      <button id="backToTrackingButton" 
              type="button" 
              class="main-button secondary-button"
              aria-label="è¿”å›ä¸»æ—¥è·Ÿè¸ªé¡µé¢">
        è¿”å›è·Ÿè¸ªåˆ—è¡¨
      </button>
      <button id="refreshButton" 
              type="button" 
              class="main-button primary-button"
              aria-label="åˆ·æ–°æ•°æ®">
        ğŸ”„ åˆ·æ–°æ•°æ®
      </button>
    </section>
    
    <!-- åŠ è½½çŠ¶æ€ -->
    <div id="loadingIndicator" class="loading-indicator hidden">
      <div class="loading-spinner"></div>
      <p>æ­£åœ¨åŠ è½½è·Ÿè¸ªäº‹ä»¶è¯¦æƒ…...</p>
    </div>
    
    <!-- é”™è¯¯ä¿¡æ¯ -->
    <div id="errorMessage" class="error-message hidden">
      <p id="errorText"></p>
    </div>
    
    <!-- è·Ÿè¸ªäº‹ä»¶è¯¦æƒ…å†…å®¹ -->
    <div id="eventDetailContent" class="event-detail-container">
      <!-- æˆå‘˜ä¿¡æ¯ -->
      <div id="memberInfo" class="member-info-card">
        <h3>æˆå‘˜ä¿¡æ¯</h3>
        <p>æ­£åœ¨åŠ è½½...</p>
      </div>
      
      <!-- ç¼ºå‹¤è¯¦æƒ… -->
      <div id="absenceDetails" class="absence-details-card">
        <h3>ç¼ºå‹¤è¯¦æƒ…</h3>
        <p>æ­£åœ¨åŠ è½½...</p>
      </div>
      
      <!-- è·Ÿè¸ªè®°å½•å†å² -->
      <div id="trackingHistory" class="tracking-records-list">
        <h3>è·Ÿè¸ªè®°å½•å†å²</h3>
        <p>æ­£åœ¨åŠ è½½...</p>
      </div>
      
      <!-- æ“ä½œæŒ‰é’® -->
      <div id="actionButtons" class="action-buttons">
        <!-- åŠ¨æ€ç”Ÿæˆæ“ä½œæŒ‰é’® -->
      </div>
    </div>
  </main>
  
  <!-- è·Ÿè¸ªå¯¹è¯æ¡† -->
  <div id="resolveTrackingDialog" class="edit-dialog hidden-dialog">
    <div class="dialog-content">
      <h3>è·Ÿè¸ª</h3>
      <div class="form-group">
        <label for="trackingDate">æ—¥æœŸï¼š</label>
        <input type="date" id="trackingDate" required>
      </div>
      <div class="form-group">
        <label for="trackingContent">å†…å®¹ï¼š</label>
        <textarea id="trackingContent" placeholder="è¯·è¯´æ˜è·Ÿè¸ªæƒ…å†µ..." required></textarea>
      </div>
      <div class="form-group">
        <label for="trackingCategory">ç±»åˆ«ï¼š</label>
        <select id="trackingCategory" required>
          <option value="">--è¯·é€‰æ‹©ç±»åˆ«--</option>
          <option value="ç”µè¯è”ç³»">ç”µè¯è”ç³»</option>
          <option value="å¾®ä¿¡è”ç³»">å¾®ä¿¡è”ç³»</option>
          <option value="ä¸Šé—¨æ‹œè®¿">ä¸Šé—¨æ‹œè®¿</option>
          <option value="å°ç»„èšä¼š">å°ç»„èšä¼š</option>
          <option value="å…¶ä»–">å…¶ä»–</option>
        </select>
      </div>
      <div class="form-group">
        <label for="trackingPerson">å›é¦ˆäººå‘˜ï¼š</label>
        <input type="text" id="trackingPerson" placeholder="è¯·è¾“å…¥å›é¦ˆäººå‘˜å§“å" required>
      </div>
      <div class="dialog-buttons">
        <button id="confirmResolve" class="save-btn">ç¡®è®¤è·Ÿè¸ª</button>
        <button id="cancelResolve" class="cancel-btn">å–æ¶ˆ</button>
      </div>
    </div>
  </div>
  
  <!-- å¿½ç•¥å¯¹è¯æ¡† -->
  <div id="ignoreTrackingDialog" class="edit-dialog hidden-dialog">
    <div class="dialog-content">
      <h3>ç»ˆæ­¢è·Ÿè¸ªäº‹ä»¶</h3>
      <div class="form-group">
        <label for="ignoreReason">ç»ˆæ­¢åŸå› ï¼š</label>
        <textarea id="ignoreReason" placeholder="è¯·è¯´æ˜ç»ˆæ­¢åŸå› ..." required></textarea>
      </div>
      <div class="form-group">
        <label for="ignoreDate">ç»ˆæ­¢æ—¥æœŸï¼š</label>
        <input type="date" id="ignoreDate" required>
      </div>
      <div class="dialog-buttons">
        <button id="confirmIgnore" class="save-btn">ç¡®è®¤ç»ˆæ­¢</button>
        <button id="cancelIgnore" class="cancel-btn">å–æ¶ˆ</button>
      </div>
    </div>
  </div>
  
  <script src="./src/utils.js"></script>
  <script src="./src/navigation-utils.js"></script>
  <script src="./src/tracking-event-detail.js"></script>
</body>
</html>
