# main.js 拆分计划

**原文件**: src/main.js (1462行)  
**目标**: 拆分为5个模块，每个模块不超过500行  
**方法**: 先建立框架，再逐步移植代码

---

## 📊 文件结构分析

| 模块名称 | 行数范围 | 代码行数 | 主要功能 |
|---------|---------|---------|---------|
| 浏览器扩展错误处理 | 8-26 | 19行 | 错误捕获 |
| 全局变量和初始化 | 27-61 | 35行 | 全局变量、DOM引用 |
| Firebase初始化 | 61-76 | 15行 | Firebase初始化 |
| 页面同步管理器 | 76-86 | 10行 | 页面同步 |
| DOM元素初始化 | 86-107 | 21行 | DOM元素 |
| 数据加载和管理 | 107-906 | 799行 | **最大模块** |
| 事件监听器初始化 | 906-984 | 78行 | 事件绑定 |
| 事件处理函数 | 984-1462 | 478行 | 业务逻辑 |

**总计**: 1462行

---

## 🎯 拆分方案

### 模块1: shared-state.js (~100行)
- 全局变量定义
- DOM元素引用
- 浏览器扩展错误处理

### 模块2: init-module.js (~250行)
- Firebase初始化
- 页面同步管理器初始化
- DOM元素初始化

### 模块3: data-loader.js (~800行)
- 数据加载和管理（最大模块）
- 包含所有数据加载逻辑

### 模块4: event-handlers.js (~400行)
- 事件监听器初始化
- 事件处理函数
- 业务逻辑

### 模块5: index.js (~50行)
- 主入口文件
- DOMContentLoaded 事件

---

**预计时间**: 45-60分钟


