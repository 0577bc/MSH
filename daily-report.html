<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MSH日报表</title>
  <link rel="stylesheet" href="./src/style.css">
  <!-- 引入配置文件 -->
  <script src="./config.js"></script>
  <!-- 引入配置管理器 -->
  <script src="./src/config-manager.js"></script>
  <!-- 引入 Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
  <!-- 引入导出功能库 -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <!-- 引入新数据管理器 -->
  <script src="./src/new-data-manager.js"></script>
</head>
<body>
  <main>
    <h1>MSH日报表</h1>
    <section class="button-row">
      <button id="backButton" type="button" aria-label="返回签到页面">返回签到页面</button>
      <button id="exportTableButton" type="button" aria-label="导出表格">导出表格</button>
    </section>
    <!-- 当日签到人员表 - 隐藏但保留 -->
    <h2 class="hidden-form">当日签到人员</h2>
    <table id="signedTable" class="attendance-table hidden-form" aria-label="当日签到人员表">
      <caption>当日签到人员表</caption>
      <thead>
        <tr>
          <th>组别</th>
          <th>姓名</th>
          <th>签到时间</th>
        </tr>
      </thead>
      <tbody id="signedList">
        <!-- 由 daily-report.js 动态填充，建议添加"加载中..."提示 -->
      </tbody>
    </table>
    <p class="hidden-form">签到总人数：<span id="totalSigned">0</span></p>
    
    <h2>各组签到情况</h2>
    <table id="unsignedTable" class="attendance-table" aria-label="各组签到情况表">
      <caption>各组签到情况表</caption>
      <thead>
        <tr>
          <th>组别</th>
          <th>早到</th>
          <th>准时</th>
          <th>迟到</th>
          <th>未签到人员</th>
        </tr>
      </thead>
      <tbody id="unsignedList">
        <!-- 由 daily-report.js 动态填充，建议添加"加载中..."提示 -->
      </tbody>
    </table>
    
    <!-- 统计和新增人员并排显示 -->
    <section class="stats-and-newcomers-container">
      <!-- 签到统计表格 -->
      <div class="statistics-section">
        <h3>今日签到统计</h3>
        <table id="statisticsTable" class="statistics-table">
          <thead>
            <tr>
              <th>统计项目</th>
              <th>人数</th>
              <th>占比</th>
            </tr>
          </thead>
          <tbody id="statisticsList">
            <tr>
              <td>早到人数</td>
              <td id="earlyCount">0</td>
              <td id="earlyPercentage">0%</td>
            </tr>
            <tr>
              <td>准时人数</td>
              <td id="onTimeCount">0</td>
              <td id="onTimePercentage">0%</td>
            </tr>
            <tr>
              <td>迟到人数</td>
              <td id="lateCount">0</td>
              <td id="latePercentage">0%</td>
            </tr>
            <tr>
              <td>应到人数</td>
              <td id="expectedCount">0</td>
              <td>-</td>
            </tr>
            <tr>
              <td>签到人数</td>
              <td id="totalCount">0</td>
              <td id="attendancePercentage">0%</td>
            </tr>
          </tbody>
        </table>
      </div>
      
      <!-- 当日新增人员 -->
      <div class="newcomers-section">
        <h3>当日新增人员表</h3>
        <table id="newcomersTable" class="newcomer-table" aria-label="当日新增人员表">
          <thead>
            <tr>
              <th>组别</th>
              <th>姓名</th>
            </tr>
          </thead>
          <tbody id="newcomersList">
            <!-- 由 daily-report.js 动态填充，建议添加"加载中..."提示 -->
          </tbody>
        </table>
        <p>新增总人数：<span id="totalNewcomers">0</span></p>
      </div>
    </section>
  </main>
  <script src="./src/utils.js"></script>
  <script src="./src/navigation-utils.js"></script>
  <script src="./src/daily-report.js"></script>
</body>
</html>