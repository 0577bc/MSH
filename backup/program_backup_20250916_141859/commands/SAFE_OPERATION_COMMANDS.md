# MSH签到系统 - 安全操作指令模板

## 📋 安全操作概述

**目的**：提供标准化的安全操作指令模板  
**适用范围**：清理、优化、整理文件等操作  
**安全等级**：高安全级别，确保系统稳定性  
**维护者**：MSH系统管理员  

## 🎯 标准安全操作指令

### **1. 文件清理指令**

#### **推荐指令（最安全）**
```
按照 CLEANUP_CHECKLIST.md 执行文件清理
```

#### **详细指令（最严格）**
```
按照清理检查清单执行文件清理，确保：
1. 运行保护检查脚本
2. 确认受保护文件清单
3. 只清理允许删除的文件类型
4. 清理后验证系统功能
```

#### **紧急清理指令**
```
紧急清理：按照 CLEANUP_CHECKLIST.md 执行，跳过非关键验证步骤
```

### **2. 代码优化指令**

#### **安全优化指令（推荐）**
```
执行安全代码优化，要求：
1. 先运行 ./protect_documents.sh 检查系统状态
2. 创建完整系统备份
3. 只进行低风险优化（注释、格式、调试日志）
4. 不修改任何核心功能逻辑
5. 优化后立即测试所有主要功能
6. 如有问题立即回滚
```

#### **渐进式优化指令**
```
执行渐进式代码优化：
1. 先备份当前系统
2. 只优化一个文件或一个功能模块
3. 立即测试该模块功能
4. 确认无问题后再进行下一步优化
5. 每步优化都要验证系统完整性
```

#### **性能优化指令（谨慎）**
```
执行性能优化，严格限制：
1. 只优化性能相关代码，不修改业务逻辑
2. 优化前记录性能基准数据
3. 优化后对比性能数据
4. 确保功能完全不变
5. 如有任何功能异常立即停止
```

### **3. 文件整理指令**

#### **安全整理指令（推荐）**
```
执行安全文件整理，要求：
1. 先运行 ./protect_documents.sh 检查系统状态
2. 创建完整系统备份
3. 只整理文档和临时文件，不移动核心功能文件
4. 保持所有文件引用路径不变
5. 整理后立即测试所有主要功能
6. 如有问题立即回滚
```

#### **渐进式整理指令**
```
执行渐进式文件整理：
1. 先备份当前系统
2. 只整理一个目录或一类文件
3. 立即测试系统功能
4. 确认无问题后再进行下一步整理
5. 每步整理都要验证系统完整性
```

#### **文档整理指令（安全）**
```
执行文档文件整理：
1. 只整理 .md 文档文件
2. 不移动任何 .html、.js、.css 文件
3. 保持文件内容不变
4. 整理后验证文档链接有效性
```

## 🛡️ 安全操作检查清单

### **操作前必检**
- [ ] 运行 `./protect_documents.sh` 检查系统状态
- [ ] 创建完整系统备份
- [ ] 确认操作范围和目标
- [ ] 制定回滚计划
- [ ] 评估操作风险等级

### **操作中监控**
- [ ] 逐步执行，及时验证
- [ ] 记录所有修改内容
- [ ] 监控系统功能状态
- [ ] 保持操作日志
- [ ] 准备紧急回滚

### **操作后验证**
- [ ] 全面测试系统功能
- [ ] 验证文件引用正确性
- [ ] 检查系统性能指标
- [ ] 确认用户界面正常
- [ ] 更新相关文档

## 🚨 紧急回滚指令

### **立即回滚指令**
```
紧急回滚：立即停止当前操作，从最新备份恢复系统
```

### **回滚步骤**
```bash
# 1. 立即停止操作
# 2. 从备份恢复
cp -r backup/pre_operation_YYYYMMDD_HHMMSS/* ./

# 3. 验证恢复结果
./protect_documents.sh

# 4. 测试系统功能
# 打开浏览器测试所有主要功能
```

## 📊 操作风险评估

### **高风险操作**
- ❌ 修改核心数据管理逻辑
- ❌ 更改Firebase同步机制
- ❌ 修改全局变量初始化
- ❌ 移动核心功能文件
- ❌ 修改文件引用路径

### **中风险操作**
- ⚠️ 修改样式和布局
- ⚠️ 优化性能相关代码
- ⚠️ 整理文档文件
- ⚠️ 添加新功能
- ⚠️ 修改错误处理逻辑

### **低风险操作**
- ✅ 添加注释和文档
- ✅ 代码格式化和命名优化
- ✅ 添加调试日志
- ✅ 清理临时文件
- ✅ 整理备份文件

## 🎯 操作指令选择指南

### **根据风险等级选择**

#### **高风险操作**
- 使用最严格的指令
- 必须包含完整备份和验证
- 建议分步骤执行
- 准备紧急回滚方案

#### **中风险操作**
- 使用标准安全指令
- 包含基本备份和验证
- 可以批量执行
- 准备回滚方案

#### **低风险操作**
- 使用简化指令
- 包含基本验证
- 可以快速执行
- 准备简单回滚

### **根据操作类型选择**

#### **清理操作**
- 优先使用：`按照 CLEANUP_CHECKLIST.md 执行文件清理`
- 备选：详细清理指令

#### **优化操作**
- 优先使用：安全代码优化指令
- 备选：渐进式优化指令

#### **整理操作**
- 优先使用：安全文件整理指令
- 备选：文档整理指令

## 📝 操作记录模板

### **操作记录格式**
```markdown
## 操作记录 - YYYY-MM-DD HH:MM

### 操作类型
- [ ] 文件清理
- [ ] 代码优化
- [ ] 文件整理
- [ ] 其他（请说明）

### 操作指令
使用的具体指令内容

### 操作范围
具体操作的文件和内容

### 风险评估
- 风险等级：高/中/低
- 主要风险点
- 预防措施

### 执行结果
- [ ] 操作成功完成
- [ ] 功能验证通过
- [ ] 性能验证通过
- [ ] 兼容性验证通过

### 异常情况
任何异常情况或注意事项

### 回滚情况
- [ ] 无需回滚
- [ ] 部分回滚
- [ ] 完全回滚
```

## 🔧 自动化操作支持

### **自动检查脚本**
```bash
# 操作前自动检查
./protect_documents.sh

# 操作后自动验证
./validate_system.sh
```

### **自动备份脚本**
```bash
# 创建操作前备份
./create_backup.sh pre_operation

# 创建操作后备份
./create_backup.sh post_operation
```

## 📞 技术支持

### **操作问题反馈**
- 操作过程中遇到问题立即停止
- 记录详细的问题描述和复现步骤
- 联系技术团队获取支持

### **紧急联系**
- 系统功能异常时立即回滚
- 数据丢失时立即从备份恢复
- 联系系统管理员获取紧急支持

## 🎯 最佳实践

### **操作前准备**
1. **充分备份**：创建完整系统备份
2. **明确目标**：确定具体要操作的内容
3. **评估风险**：评估操作的风险等级
4. **制定计划**：制定详细的操作计划

### **操作中执行**
1. **小步快跑**：每次只做小的改动
2. **及时验证**：每步都要验证功能
3. **记录变更**：详细记录所有修改
4. **保持沟通**：及时报告操作进度

### **操作后确认**
1. **全面测试**：测试所有主要功能
2. **性能监控**：监控系统性能指标
3. **用户反馈**：收集用户使用反馈
4. **文档更新**：更新相关技术文档

---
*此安全操作指令模板将根据实践经验持续完善*
