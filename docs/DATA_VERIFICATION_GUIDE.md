# MSH数据核对系统使用指南

## 概述

MSH数据核对系统是一个专门用于核对Firebase数据库、MSH系统、外部表单三个数据源信息一致性的工具。该系统可以帮助管理员快速识别数据不一致的问题，确保系统数据的准确性。

## 功能特性

### 核心功能
- **三数据源对比**: 同时显示Firebase数据库、MSH系统、外部表单的数据
- **关键要素核对**: 重点核对小组名称、UUID、花名三个核心要素
- **实时数据刷新**: 支持实时从各数据源拉取最新数据
- **智能状态识别**: 自动识别数据一致、不一致、缺失等状态

### 筛选和搜索
- **小组筛选**: 按小组名称筛选数据
- **姓名搜索**: 支持按姓名或花名搜索
- **状态筛选**: 按数据状态筛选（一致/不一致/缺失）
- **实时筛选**: 筛选条件实时生效

### 数据导出
- **完整报告导出**: 导出包含所有数据源的完整报告
- **JSON格式**: 支持JSON格式导出，便于后续分析
- **时间戳标记**: 导出文件包含时间戳，便于版本管理

## 使用方法

### 1. 访问系统
打开浏览器，访问 `data-verification.html` 页面。

### 2. 数据加载
系统会自动：
- 连接Firebase数据库
- 从MSH系统本地存储加载数据
- 连接外部表单API获取数据
- 生成对比分析

### 3. 查看数据
- **统计卡片**: 显示总成员数、数据一致数、不一致数、缺失数
- **数据源卡片**: 分别显示三个数据源的成员信息
- **对比表格**: 详细的逐行对比表格

### 4. 筛选和搜索
- 使用顶部筛选控件进行数据筛选
- 支持多条件组合筛选
- 筛选结果实时更新

### 5. 导出报告
- 点击"导出报告"按钮
- 系统会生成包含所有数据的JSON文件
- 文件自动下载到本地

## 数据状态说明

### 数据一致 (绿色)
- 三个数据源都有该成员信息
- 关键字段（姓名、小组、UUID、花名）完全一致
- 表示数据同步正常

### 数据不一致 (红色)
- 三个数据源都有该成员信息
- 但关键字段存在差异
- 需要人工核实和修正

### 数据缺失 (黄色)
- 部分数据源缺少该成员信息
- 可能是数据同步问题
- 需要检查数据同步机制

## 技术架构

### 数据源
1. **Firebase数据库**: 原始数据源，通过Firebase SDK连接
2. **MSH系统**: 从本地存储读取缓存数据
3. **外部表单**: 通过API连接外部表单系统

### 技术栈
- **前端**: HTML5, CSS3, JavaScript (ES6+)
- **后端**: Firebase Realtime Database v8
- **API**: 外部表单系统REST API
- **样式**: 响应式设计，支持移动端

## 故障排除

### 常见问题

#### 1. Firebase连接失败
- 检查网络连接
- 确认Firebase配置正确
- 检查Firebase项目权限

#### 2. MSH系统数据为空
- 确保已访问过MSH系统
- 检查本地存储是否有数据
- 尝试刷新MSH系统页面

#### 3. 外部表单连接失败
- 检查外部表单API服务状态
- 确认API配置正确
- 检查网络连接

#### 4. 数据不显示
- 刷新页面重试
- 检查浏览器控制台错误信息
- 确认所有依赖文件已加载

### 调试方法
1. 打开浏览器开发者工具
2. 查看控制台错误信息
3. 检查网络请求状态
4. 查看本地存储数据

## 最佳实践

### 数据核对流程
1. **定期核对**: 建议每周进行一次数据核对
2. **重点关注**: 重点关注数据不一致和缺失的记录
3. **及时修正**: 发现数据问题及时修正
4. **记录问题**: 记录数据问题的原因和解决方案

### 数据维护
1. **备份数据**: 定期备份重要数据
2. **监控同步**: 监控各数据源的同步状态
3. **版本控制**: 使用版本控制管理数据变更
4. **文档记录**: 记录数据维护过程

## 更新日志

### v2.0 (2025-01-23)
- 创建完整的数据核对系统
- 实现三数据源对比功能
- 添加筛选、搜索、导出功能
- 优化用户界面和用户体验

## 联系支持

如有问题或建议，请联系MSH系统开发团队。

---

**最后更新**: 2025-01-23  
**版本**: 2.0  
**维护者**: MSH系统开发团队
